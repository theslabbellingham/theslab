<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.5">


<title>THE SLAB</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico?">
<link rel="stylesheet" href="../styles/style.css">


<style>

@font-face {
  font-family: DIN;
  src: url(../fonts/DINAlternate-Bold.ttf);
}

@font-face {
  font-family: shree;
  src: url(../fonts/shree-devanagari-714.ttf);
}

body {
  font-family: DIN;
}

#shreefont {
  font-family: shree;
}

#dinfont {
  font-family: DIN;
}

a:link {
  color: #36456c;
  background-color: transparent;
  text-decoration: none;
}
a:visited {
  color: #36456c;
  background-color: transparent;
  text-decoration: none;
}
a:hover {
  color: #36456c;
  background-color: transparent;
  text-decoration: underline;
}
a:active {
  color: #36456c;
  background-color: transparent;
  text-decoration: underline;
}

/* TABLE OF SHOWS */
    body {
      padding: 40px;
      color: #36456c;
      text-transform: uppercase;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    td {
      padding: 4px 8px;
		border-bottom: 1px solid #36456c;  /* fallback for older/low-DPI browsers */
		border-bottom: 0.5px solid #36456c; /* overrides on modern/high-DPI browsers */
      vertical-align: top;
      color: #36456c;
    }

    .date {
      width: 15%;
      font-weight: bold;
      font-size: 20px;
      color: #36456c;
    }
    .venue {
      width: 20%;
    }
    .time {
      width: 15%;
    }
    .performers {
      width: 50%;
    }
	
/* BORDER */
	
	body {
      margin: 0;
      padding: 0;
      position: relative;
    }

    .left-border,
    .right-border {
      position: fixed;
      top: 0;
      height: 100vh;
      width: 30px; /* adjust to match actual image width */
      background-repeat: repeat-y;
      background-size: contain;
      z-index: 1000;
    }

    .left-border {
      left: 0;
      background-image: url('../images/Border Pattern L.png');
      background-position: left top;
    }

    .right-border {
      right: 0;
      background-image: url('../images/Border Pattern R.png');
      background-position: right top;
    }

	.content {
	margin: 0 30px 0 80px; /* 80px on the left to avoid overlap */
	padding: 20px;
	}

	
/* MENUBAR */
.final-vertical-menu {
  position: fixed;
  top: 50%;
  left: 40px; /* 30px border + 10px space */
  transform: rotate(-90deg) translateX(-50%);
  transform-origin: top left;
  display: flex;
  flex-direction: row;
  gap: 34px; /* spacing between links */
  z-index: 1100;
}

.final-vertical-menu a {
  font-size: 20px;
  font-family: DIN, sans-serif;
  color: #1f2d50;
  text-decoration: none;
  white-space: nowrap;
}

.final-vertical-menu a:hover {
  text-decoration: underline;
}

.day-small {
  font-size: 13px;
  color: #36456c;
  margin-top: 2px;
}

.final-vertical-menu a.active {
  background-color: #1f2d50;
  color: #fff8e1;
  padding: 4px 8px;
}

.single-line-row td {
  padding-top: 2px;
  padding-bottom: 2px;
  line-height: 1.1; /* adjust this as needed */
}

.no-shows {
  font-size: 13px;
  color: #36456c;
  font-family: DIN, sans-serif;
}

#searchInput::placeholder {
  color: #36456c; /* Change to any color you like */
  opacity: 1;      /* Ensures the color shows up consistently */
}



</style>

</head>
<body>

<div class="left-border"></div>

<!-- Final Rotated Vertical Menu -->
<div class="final-vertical-menu">
  <a href="../pages/archive.html">ARCHIVE</a>
  <a href="../pages/about.html">ABOUT</a>
  <a href="../pages/venues.html">VENUES</a>
  <a href="../pages/featured posters.html">FEATURED POSTERS</a>
  <a href="../pages/slab calendar.html" class="active">CAL</a>
  <a href="../index.html">HOME</a>
</div>

<div class="right-border"></div>
<div class="content">

<!–– TITLE ––>
<center><a href="../index.html"><img src="../images/Slab Copy.png" alt="slab logo" style="width:400px;height:auto;"></a></center>

<!-- ARROWS -->
<div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
  <a href="../index.html" style="font-size: 48px; color: #36456c; text-decoration: none;">&#8592;</a>
  <a href="../pages/featured posters.html" style="font-size: 48px; color: #36456c; text-decoration: none;">&#8594;</a>
</div>

<br><br>
<!–– THE BIG SCRIPT ––>

<!-- SEARCH BAR -->
<div style="text-align: right; margin: 10px 0;">
  <input 
    type="text" 
    id="searchInput" 
    placeholder="Search shows..."
    style="padding: 6px 10px; font-size: 14px; border: none; border-bottom: 1px solid #36456c; outline: none; background: transparent; color: #36456c;">
</div>

<br>

<!-- PULLS FROM concerts.csv AND PARSES COMMAS AS SEPARATORS, PUT ANY PERFORMERS' NAMES WITH COMMAS IN QUOTES TO AVOID MALFUNCTIONS -->

<table id="concertTable"></table>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
  const csvUrl = '../data/concerts.csv';
  let parsedRows = [];

  async function loadConcertData() {
    const response = await fetch(csvUrl);
    const csvText = await response.text();
    const parsed = Papa.parse(csvText, { header: true });
    parsedRows = parsed.data.filter(row => row.Date);

    renderTable(parsedRows);
  }

  function renderTable(rows) {
    const table = document.getElementById('concertTable');
    table.innerHTML = ''; // clear table

    let currentDate = '';
    let group = [];

    function renderGroup(date, groupRows) {
      const isSingleRow = groupRows.length === 1;

      groupRows.forEach((row, i) => {
        const tr = document.createElement('tr');
        if (isSingleRow) tr.classList.add('single-line-row');

        if (i === 0) {
          const td = document.createElement('td');
          td.className = 'date';
          td.style.borderBottom = 'none';
          td.rowSpan = groupRows.length;
          td.textContent = date;
          tr.appendChild(td);
        }

        if (!row.Venue?.trim() && !row.Time?.trim() && !row.Performers?.trim()) {
          const messageTd = document.createElement('td');
          messageTd.colSpan = 3;
          messageTd.innerHTML =
            '<span class="no-shows"><em>No shows today! Know of one? Fill out this submission <b><a href="https://form.jotform.com/252257562730053" target="blank">form.</a></b></em></span>';
          tr.appendChild(messageTd);
        } else {
          const venueTd = document.createElement('td');
          venueTd.className = 'venue';
          venueTd.textContent = row.Venue;

          const timeTd = document.createElement('td');
          timeTd.className = 'time';
          timeTd.textContent = row.Time;

          const performersTd = document.createElement('td');
          performersTd.className = 'performers';
          performersTd.textContent = row.Performers;

          tr.appendChild(venueTd);
          tr.appendChild(timeTd);
          tr.appendChild(performersTd);
        }

        table.appendChild(tr);
      });

      // Spacer row
      const spacer = document.createElement('tr');
      const emptyTd = document.createElement('td');
      emptyTd.colSpan = 4;
      emptyTd.style.paddingBottom = '26px';
      emptyTd.style.border = 'none';
      spacer.appendChild(emptyTd);
      table.appendChild(spacer);
    }

    for (const row of rows) {
      const date = row.Date;
      if (date !== currentDate) {
        if (group.length > 0) {
          renderGroup(currentDate, group);
          group = [];
        }
        currentDate = date;
      }
      group.push(row);
    }
    if (group.length > 0) renderGroup(currentDate, group);
  }

  // 🔍 Search function
  document.getElementById('searchInput').addEventListener('input', function () {
    const searchText = this.value.toLowerCase();
    const filtered = parsedRows.filter(row =>
      row.Date?.toLowerCase().includes(searchText) ||
      row.Venue?.toLowerCase().includes(searchText) ||
      row.Time?.toLowerCase().includes(searchText) ||
      row.Performers?.toLowerCase().includes(searchText)
    );
    renderTable(filtered);
  });

  loadConcertData();
</script>

  
  <br><br><br><br><br><br>
 <center>
 <div id="shreefont">
  <p><i>Did we miss anything? Reach out to us at <a href="mailto:theslabbellingham@gmail.com target="blank">theslabbellingham@gmail.com</a> or submit a concert by filling out this <b><u><a href="https://form.jotform.com/252257562730053" target="blank">form.</a></u></b></i></p>
  </div>
</center>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>


<!–– MENUBAR ––>
<br>
<div style="text-align: center; margin-bottom: 1px;">
    <a href="https://form.jotform.com/252257562730053" target="blank">SUBMIT SHOW</a> &nbsp | &nbsp <a href="https://form.jotform.com/252257775110051" target="blank">SUBMIT POSTER</a>
</div>

</div>

<script>
  // Get current path relative to the domain (e.g., "pages/about.html")
  const currentPath = window.location.pathname.replace(/^\/+/, "");

  // Loop through each menu link
  document.querySelectorAll(".final-vertical-menu a").forEach(link => {
    const linkHref = link.getAttribute("href").replace(/^\/+/, "");
    
    if (linkHref === currentPath) {
      link.classList.add("active");
    }
  });
</script>


</body>
</html>